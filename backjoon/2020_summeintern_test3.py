"""
목표 좌표와 범위가 주어졌을 때,
목표 좌표에서 범위 내에 있는 좌표 모두 구하기
단, 경계에 걸쳐 있는 것들은 따로 구해야 함
"""

def solution(maps, p, r):
    answer = 0
    
    for tRow in range(2, len(maps)+1):
        for tCol in range(2,len(maps)+1):
            count = 0
            for row in range((tRow-(r//2)-1), (tRow+(r//2)-1)):
                for col in range((tCol-(r//2)-1), (tCol+(r//2)-1)):

                    if row < 0 or row >= len(maps) or col < 0 or col >= len(maps):
                        continue

                    y = row - (tRow - 1.5)
                    x = col - (tCol - 1.5)
                    if (x+y < r//2) and (x-y < r//2) and (-x+y < r//2) and (-x-y < r//2): 
                        if maps[row][col] <= p:
                            count += 1
                    elif (x+y == r//2) or (x-y == r//2) or (-x+y == r//2) or (-x-y == r//2): 
                        if maps[row][col] <= (p/2):
                            count += 1

            answer = max(answer, count)
            
    return answer



"""
	p	r	result
[[1, 28, 41, 22, 25, 79, 4], [39, 20, 10, 17, 19, 18, 8], [21, 4, 13, 12, 9, 29, 19], [58, 1, 20, 5, 8, 16, 9], [5, 6, 15, 2, 39, 8, 29],[39, 7, 17, 5, 4, 49, 5], [74, 46, 8, 11, 25, 2, 11]]	19	6	17
[[47, 8, 99, 9, 85, 3, 8], [90, 93, 8, 25, 98, 15, 97], [9, 95, 91, 87, 8, 81, 9], [98, 88, 82, 89, 79, 81, 97], [97, 35, 31, 97, 81, 2, 92], [32, 16, 49, 9, 91, 89, 17], [53, 6, 35, 12, 13, 98, 5]]	78	6	11
[[9, 8, 17, 55, 19, 7], [1, 25, 5, 39, 28, 8], [88, 19, 28, 3, 2, 9], [76, 73, 7, 18, 16, 14], [99, 8, 8, 7, 11, 9], [1, 18, 4, 10, 3, 6]]	16	4	8
[[6, 3, 2, 7, 3], [7, 2, 1, 6, 8], [8, 9, 8, 4, 9], [7, 9, 2, 7, 1], [6, 3, 6, 8, 4]]	5	2	3
"""

print(solution([[1, 28, 41, 22, 25, 79, 4], [39, 20, 10, 17, 19, 18, 8], [21, 4, 13, 12, 9, 29, 19], [58, 1, 20, 5, 8, 16, 9], [5, 6, 15, 2, 39, 8, 29],[39, 7, 17, 5, 4, 49, 5], [74, 46, 8, 11, 25, 2, 11]], 19, 6))
print(solution([[47, 8, 99, 9, 85, 3, 8], [90, 93, 8, 25, 98, 15, 97], [9, 95, 91, 87, 8, 81, 9], [98, 88, 82, 89, 79, 81, 97], [97, 35, 31, 97, 81, 2, 92], [32, 16, 49, 9, 91, 89, 17], [53, 6, 35, 12, 13, 98, 5]], 78, 6))
print(solution([[9, 8, 17, 55, 19, 7], [1, 25, 5, 39, 28, 8], [88, 19, 28, 3, 2, 9], [76, 73, 7, 18, 16, 14], [99, 8, 8, 7, 11, 9], [1, 18, 4, 10, 3, 6]], 16, 4))
print(solution([[6, 3, 2, 7, 3], [7, 2, 1, 6, 8], [8, 9, 8, 4, 9], [7, 9, 2, 7, 1], [6, 3, 6, 8, 4]], 5, 2))

